# Pipeline Template to rollback deployment by reverting the pull request. 

steps:

- script: |
   pwd
   cd $(utils_artifact_path)
   ls
  displayName: Add Generated Manifest to New Branch
  workingDirectory: $(MANIFEST_DIR)

- task: ManualValidation@0
  timeoutInMinutes: 1440 # task times out in 1 day
  inputs:
    notifyUsers: |      
      sudivate@microsoft.com
    instructions: 'Please validate the build configuration and resume'
    onTimeout: 'resume' 

- task: Bash@3        
  name: "RevertPR"
  displayName: "Revert Pull request"
  inputs:
    filePath: $(utils_artifact_path)/revert-pr.sh
    arguments: '-r $(REPO_NAME) -tb $(MANIFESTS_BRANCH) -t $(PAT) -pr $(pr_num)'
    
